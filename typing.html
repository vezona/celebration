<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!--BS CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <!-- Swiper -->
    <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />
    <style>
         @import url(https://fonts.googleapis.com/css?family=Luckiest+Guy);

        * {
        margin: 0;
        padding: 0;
        }

        body{
            background-color: black;
            text-align: center;
            /* padding-top:20em; */
        }

        h1{
          padding-top:10em;
        }

        .typewrite{
            font-size: 80px;
        }

        .clickBtn{
          font-size: 80px;
        }

        canvas {
          display: block;
        }

        .swiper {
          width: 900px;
          height: 700px;
        }

        .swiper-wrapper{
          color: white
        }

        .swiper-button-prev, .swiper-button-next{
          color: #93c23a
        }

        .swiper-pagination-bullet{
          background: white
        }
        .swiper-pagination-bullet-active{
          background: #93c23a
        }

        /* flip card */
        .flip-card {
          background-color: transparent;
          width: 100%;
          height: 100%;
        }

        .flip-card-inner {
          position: relative;
          width: 100%;
          height: 100%;
          text-align: center;
          transition: transform 0.8s;
          transform-style: preserve-3d;
        }

        /* 水平翻轉 */
        .flip-card:hover .flip-card-inner {
          transform: rotateY(180deg);
        }

        /* Position the front and back side */
        .flip-card-front, .flip-card-back {
          position: absolute;
          width: 100%;
          height: 100%;
          backface-visibility: hidden;
        }

        /* 前面 */
        .flip-card-front {
          background-color: #fff;
          color: black;
        }

        /* 背面 */
        .flip-card-back {
          background-color: #fff;
          color: white;
          transform: rotateY(180deg);
        }
    </style>
</head>
<body>
    <h1>
        <a href="" class="typewrite" data-period="2000" data-type='[ "身為前端工程師們", "我們覺得寫卡片實在是太 Low 了", "於是我們決定..." ]'>
          <span class="wrap"></span>
        </a>
    </h1>
    <canvas id="canv"></canvas>

    <!-- Slider main container -->


    <!-- swiper -->
    <script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
    <!-- BS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script>
    function typing(){
        var TxtType = function(el, toRotate, period) {
          this.toRotate = toRotate;
          this.el = el;
          this.loopNum = 0;
          this.period = parseInt(period, 10) || 2000;
          this.txt = '';
          this.tick();
          this.isDeleting = false;
        };

        TxtType.prototype.tick = function() {
            var i = this.loopNum % this.toRotate.length;
            var fullTxt = this.toRotate[i];

            if (this.isDeleting) {
              this.txt = fullTxt.substring(0, this.txt.length - 1);
            } else {
              this.txt = fullTxt.substring(0, this.txt.length + 1);
            }

            this.el.innerHTML = '<span class="wrap">'+this.txt+'</span>';

            var that = this;
            var delta = 200 - Math.random() * 100; // 打字出現的速度

            if (this.isDeleting) { delta /= 2; }

            if (!this.isDeleting && this.txt === fullTxt) {
              delta = this.period;
              this.isDeleting = true;
            } else if (this.isDeleting && this.txt === '') {
              this.isDeleting = false;
              this.loopNum ++;
              delta = 500;
            }

            setTimeout(function() {
              that.tick();
            }, delta);
        };

        window.onload = function() {
          var elements = document.getElementsByClassName('typewrite');
          for (var i=0; i<elements.length; i++) {
            var toRotate = elements[i].getAttribute('data-type');
            var period = elements[i].getAttribute('data-period');
            if (toRotate) {
              new TxtType(elements[i], JSON.parse(toRotate), period);
            }
          }
          // INJECT CSS
          var css = document.createElement("style");
          css.type = "text/css";
          css.innerHTML = ".typewrite > .wrap { border-right: 0.08em solid #fff; color: #fff;}";
          document.body.appendChild(css);
        };
        
    }

    function showBtn(){
      $(document).ready(function () {
        var elements = document.querySelectorAll('.typewrite');
        elements[elements.length - 1].remove();            
      })

      // add btn
      $("h1").append('<button type="button" class="btn btn-warning clickBtn" onclick="showCanvas(carousel)">看決定</button>')
    }

    // 生日快樂亂飛
    function canvasAnimationStart() {
        // remove btn
        $('h1').remove()

        var canvas = document.getElementById("canv");
        var ctx = canvas.getContext("2d");
        // Utilities
        function randomColor() {
          return '#' + Math.random().toString(16).slice(2, 8);
        }
        
        function randomWord() {
          var word = words[Math.floor(Math.random() * words.length)];
          return word;
        }
        
        function randomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        //Make the canvas occupy the full page
        var W = window.innerWidth,
            H = window.innerHeight;
        canvas.width = W;
        canvas.height = H;
        var particles = [];
        var mouse = {};
        //Lets create some particles now
        var particle_count = 100;
        for (var i = 0; i < particle_count; i++) {
            particles.push(new particle());
        }
        canvas.addEventListener('mousedown', track_mouse, false);
        canvas.addEventListener('touch', track_mouse, false);

        function track_mouse(e) {
            mouse.x = e.pageX;
            mouse.y = e.pageY;

            for (var i = 0; i < particle_count; i++) {
              particles.push(new particle());
            }
        }

        function particle() {
            //speed, life, location, life, colors
            //speed range = -2.5 to 2.5
            this.speed = {
            x: -2.5 + Math.random() * 5,
            y: -2.5 + Math.random() * 5
            };
            //location = center of the screen
            if (mouse.x && mouse.y) {
            this.location = {
                x: mouse.x,
                y: mouse.y
            };
            } else {
            this.location = {
                x: W / 2,
                y: H / 2
            };
            }
            this.color = randomColor()

            this.font = {
            size: randomInt(3, 15)
            }
            
            this.word = randomWord()
        }

        function draw() {
            ctx.globalCompositeOperation = "source-over";
            //Painting the canvas black
            ctx.fillStyle = "black";
            ctx.fillRect(0, 0, W, H);
            ctx.globalCompositeOperation = "lighter";
            for (var i = 0; i < particles.length; i++) {
            var p = particles[i];
            ctx.beginPath();
            ctx.font = p.font.size + "vh Luckiest Guy";
            ctx.textAlign = "center";
            ctx.transition = "all 2s ease";
            ctx.fillStyle = p.color;
            ctx.fillText(p.word, p.location.x, p.location.y);
            ctx.fill();
            ctx.stroke();

            //lets move the particles
            p.location.x += p.speed.x;
            p.location.y += p.speed.y;
            
            p.speed.x += randomInt(-0.01, 0.01);
            p.speed.y += randomInt(-0.01, 0.01);
            
            // Make 'em big and small
            // Warning: Causes extreme lag
            //p.font.size += randomInt(-0.1, 0.1)
            }
        }
        setInterval(draw, 10);
        };

    // Big Word Array
    words = ['birthday','生日', 'happy', 'you', 'kuro', '樂','k大', '生日', '快樂', '樂','HBD', '快', '生'];


    const carouselTemplate = `
    <div class="swiper py-5">
      <!-- Additional required wrapper -->
      <div class="swiper-wrapper">
        <div class="swiper-slide bg-white text-black d-flex align-items-center justify-content-center" style="font-size:100px">
          猜猜是誰的祝福
        </div>
        <!-- Jin -->
        <div class="swiper-slide Jin">
          <!-- flip card -->
          <div class="flip-card">
            <div class="flip-card-inner">
              <div class="flip-card-front d-flex flex-column justify-content-center">
                <div style='font-size:50px;'>&#128175;&#127882; &#128525; &#127874; &#127873; &#129351; &#127881</div>
                <div style='font-size:50px;'>&#129351;&#127839; &#128525; &#127874; &#127880; &#127870; &#127881</div>
                <h2 style='font-size:50px;' class="my-5">大大生日快樂！！！</h2>
                <div style='font-size:50px;'>&#128519; &#128525; &#127874; &#127873; &#127870; &#10024;</div>
                <div style='font-size:50px;'>&#128588;&#128519; &#129512; &#127874; &#127873; &#127882; &#127881</div>
              </div>
              <div class="flip-card-back d-flex">
                <img class="m-auto" src="./img/jin.jpg" alt="Avatar" style="width:500px;height:500px;">
              </div>
            </div>
          </div>
        </div>
        <!-- winnie -->
        <div class="swiper-slide winnie">
          <!-- flip card -->
          <div class="flip-card">
            <div class="flip-card-inner">
              <div class="flip-card-front d-flex px-4">
                <h2 class="m-auto lh-lg">從前從前，有個女生對他的主管說：從前從前，有個女生對他的主管說：從前從前，有個女生對他的主管說:...</h2>
              </div>
              <div class="flip-card-back d-flex">
                <img class="m-auto" src="./img/winnie.png" alt="Avatar" style="width:700px;height:500px;">
              </div>
            </div>
          </div>
        </div>
        <!-- shawn -->
        <div class="swiper-slide shawn">
          <div class="flip-card">
            <div class="flip-card-inner">
              <div class="flip-card-front d-flex p-5 flex-wrap">
                <img src="./img/image (1).png" style="width:200px;height:200px">
                <img src="./img/image (2).png" style="width:200px;height:200px">
                <img src="./img/image (3).png" style="width:200px;height:200px">
                <img src="./img/image (4).png" style="width:200px;height:200px">
                <img src="./img/image (5).png" style="width:200px;height:200px">
                <img src="./img/image (6).png" style="width:200px;height:200px">
                <img src="./img/image (7).png" style="width:200px;height:200px">
                <img src="./img/image (8).png" style="width:200px;height:200px">
              </div>
              <div class="flip-card-back d-flex">
                <img class="m-auto" src="./img/shawn.jpg" alt="Avatar" style="width:300px;height:300px;">
              </div>
            </div>
          </div>
        </div>
        <!-- Jim -->
        <div class="swiper-slide Jim">
          <div class="flip-card">
            <div class="flip-card-inner">
              <div class="flip-card-front d-flex px-4">
                <h2 class="m-auto">生日快樂，以上今天</h2>
              </div>
              <div class="flip-card-back d-flex">
                <img class="m-auto" src="./img/jim.jpg" alt="Avatar" style="width:300px;height:300px;">
              </div>
            </div>
          </div>
        </div>
        <!-- rei -->
        <div class="swiper-slide rei">
          <div class="flip-card">
            <div class="flip-card-inner">
              <div class="flip-card-front d-flex px-4">
                <h2 class="m-auto">小溡也祝你生日快樂~</h2>
              </div>
              <div class="flip-card-back d-flex">
                <img class="m-auto" src="./img/rei.jpg" alt="Avatar" style="width:300px;height:300px;">
              </div>
            </div>
          </div>
        </div>
        <!-- norah -->
        <div class="swiper-slide rei">
          <div class="flip-card">
            <div class="flip-card-inner">
              <div class="flip-card-front d-flex px-4">
                <h2 class="m-auto text-decoration-line-through">好像來要買個蛋糕、加個鞭炮、再來點氣球?</h2>
              </div>
              <div class="flip-card-back d-flex">
                <img class="m-auto w-full" src="./img/norah.jpg" alt="Avatar" style="width:800px;height:500px;">
              </div>
            </div>
          </div>
        </div>
        <!-- mandy -->
        <div class="swiper-slide rei">
          <div class="flip-card">
            <div class="flip-card-inner">
              <div class="flip-card-front d-flex px-5">
                <h2 class="m-auto">米漿在這祝 Kuro 大大 Happy Birthday!，希望你的願望都能成真喔～～</h2>
              </div>
              <div class="flip-card-back d-flex">
                <img class="m-auto" src="./img/mandy2.jpg" alt="Avatar" style="width:400px;height:400px;">
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- If we need pagination -->
      <div class="swiper-pagination"></div>

      <!-- If we need navigation buttons -->
      <div class="swiper-button-prev"></div>
      <div class="swiper-button-next"></div>

      <!-- If we need scrollbar -->
      <div class="swiper-scrollbar"></div>
    </div>
    `
    
    // carousel
    function carousel(){
      // 刪除canvas
      $('canvas').remove()
      // 加上 carousel 的html tag
      $('body').append(carouselTemplate)
      // carousel animation
      const swiper = new Swiper('.swiper', {
        // Optional parameters
        direction: 'horizontal',
        loop: true,

        // If we need pagination
        pagination: {
          el: '.swiper-pagination',
        },

        // Navigation arrows
        navigation: {
          nextEl: '.swiper-button-next',
          prevEl: '.swiper-button-prev',
        },

        scrollbar: {
          el: '.swiper-scrollbar',
        },

        // autoplay
        autoplay: {
          delay: 4000,
        },
      });
    }


    // 執行
    typing()

    // showBtn()
    setTimeout(function(){showBtn()}, 15000)

    // 點擊按鈕後 showCanvas
    function showCanvas(callback){
      canvasAnimationStart()

      setTimeout(function(){
              if(typeof callback === 'function'){
                callback()
              }
            }, 4000)
    }
   
    </script>
</body>
</html>